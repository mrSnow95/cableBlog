<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.8.0 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Computational Geometry in C++ - pi_squared</title>




<meta name="description" content="In this post i just want to make a compilation of useful C++ computational geometry algorithms used in Competitive Programming. One note is that it is defined \(\epsilon = 10^{-9}\) in order to define at which precision two points are the same. But it may cause bugs depending on the level of precision of the problem. For example, the following code giver an error:">




<meta name="author" content="Bruno Neves">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="pi_squared">
<meta property="og:title" content="Computational Geometry in C++">


  <link rel="canonical" href="http://localhost:4000/cableBlog/Computational-Geometry-in-C++/">
  <meta property="og:url" content="http://localhost:4000/cableBlog/Computational-Geometry-in-C++/">



  <meta property="og:description" content="In this post i just want to make a compilation of useful C++ computational geometry algorithms used in Competitive Programming. One note is that it is defined \(\epsilon = 10^{-9}\) in order to define at which precision two points are the same. But it may cause bugs depending on the level of precision of the problem. For example, the following code giver an error:">

















  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2021-02-01T00:00:00+00:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "",
      "url" : "http://localhost:4000/cableBlog",
      "sameAs" : null
    }
  </script>







<!-- end SEO -->


<link href="http://localhost:4000/cableBlog/feed.xml" type="application/atom+xml" rel="alternate" title="pi_squared Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>



<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/cableBlog/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [],
      displayMath: [],
      processEscapes: false,
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>



<!-- end custom head snippets -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/cableBlog/">pi_squared</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/cableBlog/about/" >About</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/cableBlog/posts/" >Posts</a>
            </li>
          
        </ul>
        
        <button class="greedy-nav__toggle" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="http://localhost:4000/cableBlog/assets/images/profile-1.jpg" alt="Bruno Neves" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Bruno Neves</h3>
    
    
      <p class="author__bio" itemprop="description">
        Computer Engineer, just a guy that loves Technology, Programming and Math :)
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Braga, Portugal</span>
        </li>
      

      

      
        <li>
          <a href="mailto:neves.brunobr@gmail.com">
            <meta itemprop="email" content="neves.brunobr@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      
        <li>
          <a href="https://instagram.com/brunosszaa" itemprop="sameAs">
            <i class="fa fa-fw fa-instagram" aria-hidden="true"></i> Instagram
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://github.com/mrSnow95" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Computational Geometry in C++">
    <meta itemprop="description" content="In this post i just want to make a compilation of useful C++ computational geometry algorithms used in Competitive Programming. One note is that it is defined \(\epsilon = 10^{-9}\) in order to define at which precision two points are the same. But it may cause bugs depending on the level of precision of the problem. For example, the following code giver an error:">
    <meta itemprop="datePublished" content="February 01, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Computational Geometry in C++
</h1>
          <p class="page__meta">
            
              <time datetime="2021-02-01T00:00:00+00:00">February 01, 2021</time> &nbsp;&nbsp;&nbsp;
            
            
              <i class="fa fa-clock-o" aria-hidden="true"></i> 




  8 minute read
 &nbsp;&nbsp;&nbsp;
            
          </p>
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>In this post i just want to make a compilation of useful C++ computational geometry algorithms used in Competitive Programming. One note is that it is defined \(\epsilon = 10^{-9}\) in order to define at which precision two points are the same. But it may cause bugs depending on the level of precision of the problem. For example, the following code giver an error:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define EPS 1e-9
</span>
<span class="k">struct</span> <span class="nc">point</span><span class="p">{</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="n">point</span><span class="p">(){</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;}</span>
    <span class="n">point</span><span class="p">(</span><span class="kt">double</span> <span class="n">_x</span><span class="p">,</span><span class="kt">double</span> <span class="n">_y</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="n">_x</span><span class="p">;</span><span class="n">y</span> <span class="o">=</span> <span class="n">_y</span><span class="p">;}</span>

    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">EPS</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">==</span> <span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="c1">// error in precision</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">});</span>
    <span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="mf">1e-9</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">begin</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">end</span><span class="p">(</span><span class="n">p</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">pt</span><span class="o">:</span><span class="n">p</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%.9lf , %.9lf</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">pt</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">pt</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The code depends specially of Analytic Geometry, Cross Products, Dot products and some classic Euclidean Geometry theorems:</p>

<hr />

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;math.h&gt;
</span>
<span class="cp">#define EPS 1e-9
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">double</span> <span class="n">ld</span><span class="p">;</span>


<span class="c1">///////////////// POINT /////////////////////</span>

<span class="k">struct</span> <span class="nc">point_i</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="n">point_i</span><span class="p">(){</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
    <span class="n">point_i</span><span class="p">(</span><span class="kt">int</span> <span class="n">_x</span><span class="p">,</span><span class="kt">int</span> <span class="n">_y</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="n">_x</span><span class="p">;</span><span class="n">y</span> <span class="o">=</span> <span class="n">_y</span><span class="p">;}</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">point</span><span class="p">{</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="n">point</span><span class="p">(){</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;}</span>
    <span class="n">point</span><span class="p">(</span><span class="kt">double</span> <span class="n">_x</span><span class="p">,</span><span class="kt">double</span> <span class="n">_y</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="n">_x</span><span class="p">;</span><span class="n">y</span> <span class="o">=</span> <span class="n">_y</span><span class="p">;}</span>

    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">EPS</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">==</span> <span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">double</span> <span class="nf">hypot</span><span class="p">(</span><span class="kt">double</span> <span class="n">dx</span><span class="p">,</span><span class="kt">double</span> <span class="n">dy</span><span class="p">){</span><span class="k">return</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">;}</span>
<span class="kt">double</span> <span class="nf">dist</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">p1</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">p2</span><span class="p">){</span><span class="k">return</span> <span class="n">hypot</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>

<span class="kt">double</span> <span class="nf">DEG_to_RAD</span><span class="p">(</span><span class="kt">double</span> <span class="n">d</span><span class="p">){</span><span class="k">return</span> <span class="n">d</span><span class="o">*</span><span class="n">M_PI</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">;}</span>
<span class="kt">double</span> <span class="nf">RAD_to_DEG</span><span class="p">(</span><span class="kt">double</span> <span class="n">r</span><span class="p">){</span><span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="mf">180.0</span> <span class="o">/</span> <span class="n">M_PI</span><span class="p">;}</span>

<span class="n">point</span> <span class="nf">rotate</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">,</span><span class="kt">double</span> <span class="n">theta_deg</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">rad</span> <span class="o">=</span> <span class="n">DEG_to_RAD</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">point</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">),</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">));</span>
<span class="p">}</span>



<span class="c1">////////////////// LINE //////////////////////</span>


<span class="k">struct</span> <span class="nc">line</span> <span class="p">{</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;};</span>
<span class="kt">void</span> <span class="nf">pointsToLine</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span><span class="n">p1</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span><span class="n">p2</span><span class="p">,</span><span class="n">line</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">)</span> <span class="n">l</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="p">};</span>
    <span class="k">else</span> <span class="n">l</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="p">};</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">pointSlopeToLine</span><span class="p">(</span><span class="n">point</span> <span class="n">p</span><span class="p">,</span><span class="kt">double</span> <span class="n">m</span><span class="p">,</span><span class="n">line</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">){</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">-</span><span class="n">m</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="p">(</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="p">)</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">areParallel</span><span class="p">(</span><span class="n">line</span> <span class="n">l1</span><span class="p">,</span><span class="n">line</span> <span class="n">l2</span><span class="p">){</span> <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">a</span> <span class="o">-</span> <span class="n">l2</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">l2</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">;}</span>
<span class="kt">bool</span> <span class="nf">areSame</span><span class="p">(</span><span class="n">line</span> <span class="n">l1</span><span class="p">,</span><span class="n">line</span> <span class="n">l2</span><span class="p">){</span><span class="k">return</span> <span class="n">areParallel</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span> <span class="n">l2</span><span class="p">.</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">;}</span>

<span class="kt">bool</span> <span class="nf">areIntersect</span><span class="p">(</span><span class="n">line</span> <span class="n">l1</span><span class="p">,</span><span class="n">line</span> <span class="n">l2</span><span class="p">,</span><span class="n">point</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">areParallel</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">))</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">l2</span><span class="p">.</span><span class="n">b</span><span class="o">*</span><span class="n">l1</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span> <span class="n">l1</span><span class="p">.</span><span class="n">b</span><span class="o">*</span><span class="n">l2</span><span class="p">.</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">l2</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">l1</span><span class="p">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">l1</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">l2</span><span class="p">.</span><span class="n">b</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">EPS</span><span class="p">)</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">l1</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">l1</span><span class="p">.</span><span class="n">c</span><span class="p">);</span>
    <span class="k">else</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">l2</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">l2</span><span class="p">.</span><span class="n">c</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1">///////////////// VECTOR ///////////////////</span>


<span class="k">struct</span> <span class="nc">vec</span><span class="p">{</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="n">vec</span><span class="p">(</span><span class="kt">double</span> <span class="n">_x</span><span class="p">,</span><span class="kt">double</span> <span class="n">_y</span><span class="p">){</span><span class="n">x</span> <span class="o">=</span> <span class="n">_x</span><span class="p">;</span><span class="n">y</span> <span class="o">=</span> <span class="n">_y</span><span class="p">;}</span>
<span class="p">};</span>

<span class="n">vec</span> <span class="nf">toVec</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span> <span class="k">return</span> <span class="n">vec</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>

<span class="n">vec</span> <span class="nf">scale</span><span class="p">(</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">,</span><span class="kt">double</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="n">vec</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">s</span><span class="o">*</span><span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>

<span class="kt">double</span> <span class="nf">norm</span><span class="p">(</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">){</span><span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">hypot</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">));}</span>
<span class="kt">double</span> <span class="nf">norm_sq</span><span class="p">(</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">){</span><span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="mi">2</span><span class="p">);}</span>


<span class="n">point</span> <span class="nf">translate</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span><span class="n">p</span><span class="p">,</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">){</span><span class="k">return</span> <span class="n">point</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>



<span class="kt">double</span> <span class="nf">dot</span><span class="p">(</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">vec</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;}</span>

<span class="kt">double</span> <span class="nf">angle</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span>
    <span class="n">vec</span> <span class="n">ao</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">o</span><span class="p">);</span>
    <span class="n">vec</span> <span class="n">bo</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">o</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">ao</span><span class="p">,</span><span class="n">bo</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">(</span><span class="n">ao</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="nf">distToLine</span><span class="p">(</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">point</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">,</span><span class="n">point</span><span class="o">&amp;</span> <span class="n">c</span><span class="p">){</span>
    <span class="n">vec</span> <span class="n">ap</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
    <span class="n">vec</span> <span class="n">ab</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">u</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span><span class="n">ab</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">(</span><span class="n">ab</span><span class="p">);</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">translate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">scale</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span><span class="n">u</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">dist</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">c</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">double</span> <span class="nf">distToLineSegment</span><span class="p">(</span><span class="n">point</span> <span class="n">p</span><span class="p">,</span><span class="n">point</span> <span class="n">a</span><span class="p">,</span><span class="n">point</span> <span class="n">b</span><span class="p">,</span><span class="n">point</span><span class="o">&amp;</span> <span class="n">c</span><span class="p">){</span>
    <span class="n">vec</span> <span class="n">ap</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="p">,</span> <span class="n">ab</span> <span class="o">=</span> <span class="n">toVec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">u</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span><span class="n">ab</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">(</span><span class="n">ab</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">){</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">dist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">){</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">dist</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">distToLine</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">double</span> <span class="nf">cross</span><span class="p">(</span><span class="n">vec</span> <span class="n">a</span><span class="p">,</span><span class="n">vec</span> <span class="n">b</span><span class="p">){</span> <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">bool</span> <span class="nf">ccw</span><span class="p">(</span><span class="n">point</span> <span class="n">p</span><span class="p">,</span><span class="n">point</span> <span class="n">q</span><span class="p">,</span><span class="n">point</span> <span class="n">r</span><span class="p">){</span> <span class="c1">//returns true if point r is on the left of line pq</span>
    <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">toVec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">r</span><span class="p">),</span><span class="n">toVec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>  <span class="o">&gt;</span> <span class="n">EPS</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 0 if inside , 1 if on border , - 1 if outside</span>
<span class="kt">int</span> <span class="nf">insideCircle</span><span class="p">(</span><span class="k">const</span> <span class="n">point_i</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">,</span><span class="k">const</span> <span class="n">point_i</span><span class="o">&amp;</span> <span class="n">c</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">;</span> <span class="kt">int</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">Euc</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">,</span> <span class="n">rSq</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">Euc</span> <span class="o">&lt;</span> <span class="n">rSq</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="n">Euc</span> <span class="o">==</span> <span class="n">rSq</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>


<span class="c1">//////////// CIRCLE //////////////</span>

<span class="kt">int</span> <span class="nf">insideCircle</span><span class="p">(</span><span class="n">point_i</span> <span class="n">p</span><span class="p">,</span> <span class="n">point_i</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// all integer version</span>
  <span class="kt">int</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">c</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">Euc</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">,</span> <span class="n">rSq</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="p">;</span>            <span class="c1">// all integer</span>
  <span class="k">return</span> <span class="n">Euc</span> <span class="o">&lt;</span> <span class="n">rSq</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">Euc</span> <span class="o">==</span> <span class="n">rSq</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>    <span class="c1">// inside/border/outside</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">circle2PtsRad</span><span class="p">(</span><span class="n">point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">point</span> <span class="n">p2</span><span class="p">,</span> <span class="kt">double</span> <span class="n">r</span><span class="p">,</span> <span class="n">point</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// to get the other center, reverse p1 and p2</span>
  <span class="kt">double</span> <span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> 
              <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
  <span class="kt">double</span> <span class="n">det</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">r</span> <span class="o">/</span> <span class="n">d2</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">det</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">det</span><span class="p">);</span>
  <span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">+</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">;</span>
  <span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">+</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">;</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1">// returns true if point d is inside the circumCircle defined by a,b,c</span>
<span class="kt">int</span> <span class="nf">inCircumCircle</span><span class="p">(</span><span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">point</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span> <span class="n">c</span><span class="p">,</span> <span class="n">point</span> <span class="n">d</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span>
         <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span>
         <span class="p">((</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span>
         <span class="p">((</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span>
         <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">-</span>
         <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">d</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//////// TRIANGLE ///////////////</span>

<span class="kt">double</span> <span class="nf">perimeter</span><span class="p">(</span><span class="kt">double</span> <span class="n">ab</span><span class="p">,</span> <span class="kt">double</span> <span class="n">bc</span><span class="p">,</span> <span class="kt">double</span> <span class="n">ca</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">ab</span> <span class="o">+</span> <span class="n">bc</span> <span class="o">+</span> <span class="n">ca</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="nf">perimeter</span><span class="p">(</span><span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">point</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">dist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">dist</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">dist</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="nf">area</span><span class="p">(</span><span class="kt">double</span> <span class="n">ab</span><span class="p">,</span> <span class="kt">double</span> <span class="n">bc</span><span class="p">,</span> <span class="kt">double</span> <span class="n">ca</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Heron's formula, split sqrt(a*b) into sqrt(a)*sqrt(b)</span>
  <span class="kt">double</span> <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">perimeter</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">ca</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">ab</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">bc</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">ca</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="nf">area</span><span class="p">(</span><span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">point</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">area</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">dist</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">dist</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">canFormTriangle</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="kt">double</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">////////// POLYGONS ///////////</span>

<span class="c1">// returns true if we always make the same turn</span>
<span class="c1">// while examining all the edges of the polygon one by one</span>
<span class="kt">bool</span> <span class="nf">isConvex</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">P</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="c1">// a point/sz=2 or a line/sz=3 is not convex  </span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="kt">bool</span> <span class="n">firstTurn</span> <span class="o">=</span> <span class="n">ccw</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>        <span class="c1">// remember one result,</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>                 <span class="c1">// compare with the others</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span> <span class="o">!=</span> <span class="n">firstTurn</span><span class="p">)</span>
      <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>                              <span class="c1">// different -&gt; concave</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>                                   <span class="c1">// otherwise -&gt; convex</span>
<span class="p">}</span>

<span class="c1">// returns 1/0/-1 if point p is inside/on (vertex/edge)/outside of</span>
<span class="c1">// either convex/concave polygon P</span>
<span class="kt">int</span> <span class="nf">insidePolygon</span><span class="p">(</span><span class="n">point</span> <span class="n">pt</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">P</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>                         <span class="c1">// avoid point or line</span>
  <span class="kt">bool</span> <span class="n">on_polygon</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>                  <span class="c1">// on vertex/edge?</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pt</span><span class="p">)</span> <span class="o">+</span> <span class="n">dist</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">dist</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">EPS</span><span class="p">)</span>
      <span class="n">on_polygon</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">on_polygon</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>                      <span class="c1">// pt is on polygon</span>
  <span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>                              <span class="c1">// first = last point</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
      <span class="n">sum</span> <span class="o">+=</span> <span class="n">angle</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pt</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>            <span class="c1">// left turn/ccw</span>
    <span class="k">else</span>
      <span class="n">sum</span> <span class="o">-=</span> <span class="n">angle</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pt</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>            <span class="c1">// right turn/cw</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">sum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">M_PI</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>              <span class="c1">// 360d-&gt;in, 0d-&gt;out</span>
<span class="p">}</span>

<span class="c1">// cuts polygon Q along the line formed by point A-&gt;point B (order matters)</span>
<span class="c1">// (note: the last point must be the same as the first point)</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">cutPolygon</span><span class="p">(</span><span class="n">point</span> <span class="n">A</span><span class="p">,</span> <span class="n">point</span> <span class="n">B</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">Q</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Q</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="n">left1</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">toVec</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">toVec</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">left2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Q</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">left2</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">toVec</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">toVec</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">left1</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">EPS</span><span class="p">)</span> <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>         <span class="c1">// Q[i] is on the left</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">left1</span><span class="o">*</span><span class="n">left2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">EPS</span><span class="p">)</span>                      <span class="c1">// crosses line AB</span>
      <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">lineIntersectSeg</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">P</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span><span class="p">.</span><span class="n">front</span><span class="p">()))</span>
    <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">front</span><span class="p">());</span>                      <span class="c1">// wrap around</span>
  <span class="k">return</span> <span class="n">P</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">CH_Graham</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">Pts</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// overall O(n log n)</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">P</span><span class="p">(</span><span class="n">Pts</span><span class="p">);</span>                          <span class="c1">// copy all points</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>                                  <span class="c1">// point/line/triangle</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="n">P</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>    <span class="c1">// corner case</span>
    <span class="k">return</span> <span class="n">P</span><span class="p">;</span>                                    <span class="c1">// the CH is P itself</span>
  <span class="p">}</span>

  <span class="c1">// first, find P0 = point with lowest Y and if tie: rightmost X</span>
  <span class="kt">int</span> <span class="n">P0</span> <span class="o">=</span> <span class="n">min_element</span><span class="p">(</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">P</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="o">-</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="n">swap</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">P0</span><span class="p">]);</span>                             <span class="c1">// swap P[P0] with P[0]</span>

  <span class="c1">// second, sort points by angle around P0, O(n log n) for this sort</span>
  <span class="n">sort</span><span class="p">(</span><span class="o">++</span><span class="n">P</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">P</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">point</span> <span class="n">a</span><span class="p">,</span> <span class="n">point</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">ccw</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>                      <span class="c1">// use P[0] as the pivot</span>
  <span class="p">});</span>

  <span class="c1">// third, the ccw tests, although complex, it is just O(n)</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">({</span><span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">]});</span>         <span class="c1">// initial S</span>
  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>                                     <span class="c1">// then, we check the rest</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>                                <span class="c1">// n &gt; 3, O(n)</span>
    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">S</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ccw</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>                 <span class="c1">// CCW turn</span>
      <span class="n">S</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]);</span>                       <span class="c1">// accept this point</span>
    <span class="k">else</span>                                         <span class="c1">// CW turn</span>
      <span class="n">S</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>                              <span class="c1">// pop until a CCW turn</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">S</span><span class="p">;</span>                                      <span class="c1">// return the result</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">CH_Andrew</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">Pts</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// overall O(n log n)</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Pts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">point</span><span class="o">&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">);</span>
  <span class="n">sort</span><span class="p">(</span><span class="n">Pts</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">Pts</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>                  <span class="c1">// sort the points by x/y</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>                  <span class="c1">// build lower hull</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">ccw</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Pts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">--</span><span class="n">k</span><span class="p">;</span>
    <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pts</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>       <span class="c1">// build upper hull</span>
    <span class="k">while</span> <span class="p">((</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">ccw</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Pts</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">--</span><span class="n">k</span><span class="p">;</span>
    <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pts</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">H</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">H</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-02-01T00:00:00+00:00">February 01, 2021</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Computational+Geometry+in+C%2B%2B%20http%3A%2F%2Flocalhost%3A4000%2FcableBlog%2FComputational-Geometry-in-C%2B%2B%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FcableBlog%2FComputational-Geometry-in-C%2B%2B%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2FcableBlog%2FComputational-Geometry-in-C%2B%2B%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FcableBlog%2FComputational-Geometry-in-C%2B%2B%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/cableBlog/Quake-and-the-Fast-Inverse-Square-Root/" class="pagination--pager" title="Quake III and the Fast Inverse Square Root
">Previous</a>
    
    
      <a href="http://localhost:4000/cableBlog/Optimizing-Code-Performance-and-control-flow-with-Async/" class="pagination--pager" title="Optimizing Code Performance and control flow with Async
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/cableBlog/A-Vector-Space-Indexing-Engine-in-Python/" rel="permalink">2021-06-06-A Vector Space Indexing Engine in Python
</a>
      
    </h2>
    <p class="page__meta">
      
        <time datetime="2021-06-06T00:00:00+01:00">June 06, 2021</time> &nbsp;&nbsp;&nbsp;
      
      
        <i class="fa fa-clock-o" aria-hidden="true"></i> 




  6 minute read
 &nbsp;&nbsp;&nbsp;
      
    </p>
    <p class="archive__item-excerpt" itemprop="description">A simple Search Engine its a pretty simple thing to do. Here is an example indexer using Python.

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/cableBlog/A-Simple-Neural-Net/" rel="permalink">2021-06-06-A Simple Neural Net
</a>
      
    </h2>
    <p class="page__meta">
      
        <time datetime="2021-06-06T00:00:00+01:00">June 06, 2021</time> &nbsp;&nbsp;&nbsp;
      
      
        <i class="fa fa-clock-o" aria-hidden="true"></i> 




  7 minute read
 &nbsp;&nbsp;&nbsp;
      
    </p>
    <p class="archive__item-excerpt" itemprop="description">Neural Networks arent that complicated! The term neural network gets used as a buzzword a lot, but in reality theyre often much simpler than people imagi...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/cableBlog/Scalibility-and-Architectural-Patterns/" rel="permalink">Scalability and Architectural Patterns in Node.js
</a>
      
    </h2>
    <p class="page__meta">
      
        <time datetime="2021-06-01T00:00:00+01:00">June 01, 2021</time> &nbsp;&nbsp;&nbsp;
      
      
        <i class="fa fa-clock-o" aria-hidden="true"></i> 




  5 minute read
 &nbsp;&nbsp;&nbsp;
      
    </p>
    <p class="archive__item-excerpt" itemprop="description">Node.js is a non-blocking single thread architecture that works great for applications handling a moderate number of requests per second (usually a few hundr...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/cableBlog/Words-in-Text-Using-TF-IDF/" rel="permalink">Words in Text Using TF-IDF
</a>
      
    </h2>
    <p class="page__meta">
      
        <time datetime="2021-03-01T00:00:00+00:00">March 01, 2021</time> &nbsp;&nbsp;&nbsp;
      
      
        <i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 minute read
 &nbsp;&nbsp;&nbsp;
      
    </p>
    <p class="archive__item-excerpt" itemprop="description">TF-IDF stands for Term Frequency, Inverse Document Frequency. Its a way to score the importance of words (or terms) in a document based on how frequentl...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="https://github.com/mrSnow95"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/cableBlog/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 pi_squared. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/cableBlog/assets/js/main.min.js"></script>







<

  </body>
</html>